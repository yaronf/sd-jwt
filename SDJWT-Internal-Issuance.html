<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>SDJWT.Internal.Issuance</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">sd-jwt-0.1.0.1: Selective Disclosure for JSON Web Tokens (RFC 9901)</span><ul class="links" id="page-menu"><li id="quick-jump-button"><a href="#">Quick Jump</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">SDJWT.Internal.Issuance</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Public API</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>SD-JWT issuance: Creating SD-JWTs from claims sets.</p><p>This module provides functions for creating SD-JWTs on the issuer side.
 It handles marking claims as selectively disclosable, creating disclosures,
 computing digests, and building the final signed JWT.</p><h2>Nested Structures</h2><p>This module supports nested structures (RFC 9901 Sections 6.2 and 6.3) using
 JSON Pointer syntax (RFC 6901) for specifying nested claim paths.</p><h3>JSON Pointer Syntax</h3><p>Nested paths use forward slash (<code>/</code>) as a separator. Paths can refer to both
 object properties and array elements:</p><pre>-- Object properties
[&quot;address/street_address&quot;, &quot;address/locality&quot;]
</pre><p>This marks <code>street_address</code> and <code>locality</code> within the <code>address</code> object as
 selectively disclosable.</p><pre>-- Array elements
[&quot;nationalities/0&quot;, &quot;nationalities/2&quot;]
</pre><p>This marks elements at indices 0 and 2 in the <code>nationalities</code> array as
 selectively disclosable.</p><pre>-- Mixed object and array paths
[&quot;address/street_address&quot;, &quot;nationalities/1&quot;]
</pre><h3>Ambiguity Resolution</h3><p>Paths with numeric segments (e.g., <code>[&quot;x/22&quot;]</code>) are ambiguous:
 they could refer to an array element at index 22, or an object property
 with key <code>&quot;22&quot;</code>. The library resolves this ambiguity by checking the actual
 claim type at runtime:</p><ul><li>If <code>x</code> is an array &#8594; <code>[&quot;x/22&quot;]</code> refers to array element at index 22</li><li>If <code>x</code> is an object &#8594; <code>[&quot;x/22&quot;]</code> refers to object property <code>&quot;22&quot;</code></li></ul><p>This follows JSON Pointer semantics (RFC 6901) where the path alone doesn't
 determine the type.</p><h3>Escaping Special Characters</h3><p>JSON Pointer provides escaping for keys containing special characters:</p><ul><li><code>~1</code> represents a literal forward slash <code>/</code></li><li><code>~0</code> represents a literal tilde <code>~</code></li></ul><p>Examples:</p><ul><li><code>[&quot;contact~1email&quot;]</code> &#8594; marks the literal key <code>&quot;contact/email&quot;</code> as selectively disclosable</li><li><code>[&quot;user~0name&quot;]</code> &#8594; marks the literal key <code>&quot;user~name&quot;</code> as selectively disclosable</li><li><code>[&quot;address/email&quot;]</code> &#8594; marks <code>email</code> within <code>address</code> object as selectively disclosable</li></ul><h3>Nested Structure Patterns</h3><p>The module supports two patterns for nested structures:</p><ol><li value="1"><em>Structured SD-JWT</em> (Section 6.2): Parent object stays in payload with <code>_sd</code> array
    containing digests for sub-claims.</li><li value="2"><em>Recursive Disclosures</em> (Section 6.3): Parent is selectively disclosable, and its
    disclosure contains an <code>_sd</code> array with digests for sub-claims.</li></ol><p>The pattern is automatically detected based on whether the parent claim is also
 in the selective claims list.</p><h3>Examples</h3><p>Structured SD-JWT (Section 6.2):</p><pre>buildSDJWTPayload SHA256 [&quot;address/street_address&quot;, &quot;address/locality&quot;] claims
</pre><p>This creates a payload where <code>address</code> object contains an <code>_sd</code> array.</p><p>Recursive Disclosures (Section 6.3):</p><pre>buildSDJWTPayload SHA256 [&quot;address&quot;, &quot;address/street_address&quot;, &quot;address/locality&quot;] claims
</pre><p>This creates a payload where <code>address</code> digest is in top-level <code>_sd</code>, and the
 <code>address</code> disclosure contains an <code>_sd</code> array with sub-claim digests.</p><p>Array Elements:</p><pre>buildSDJWTPayload SHA256 [&quot;nationalities/0&quot;, &quot;nationalities/2&quot;] claims
</pre><p>This marks array elements at indices 0 and 2 as selectively disclosable.</p><p>Nested Arrays:</p><pre>buildSDJWTPayload SHA256 [&quot;nested_array/0/0&quot;, &quot;nested_array/0/1&quot;, &quot;nested_array/1/0&quot;] claims
</pre><p>This marks nested array elements. The path <code>[&quot;nested_array/0/0&quot;]</code> refers to
 element at index 0 of the array at index 0 of <code>nested_array</code>.</p><p>Mixed Object and Array Paths:</p><pre>buildSDJWTPayload SHA256 [&quot;address/street_address&quot;, &quot;nationalities/1&quot;] claims
</pre><p>This marks both an object property and an array element as selectively disclosable.</p><h2>Decoy Digests</h2><p>Decoy digests are optional random digests added to <code>_sd</code> arrays to obscure
 the actual number of selectively disclosable claims. This is useful for
 privacy-preserving applications where you want to hide how many claims are
 selectively disclosable.</p><p>To use decoy digests:</p><ol><li value="1">Build the SD-JWT payload using buildSDJWTPayload</li><li value="2">Generate decoy digests using addDecoyDigest</li><li value="3">Manually add them to the <code>_sd</code> array in the payload</li><li value="4">Sign the modified payload</li></ol><p>Example:</p><pre>-- Build the initial payload
(payload, disclosures) &lt;- buildSDJWTPayload SHA256 [&quot;given_name&quot;, &quot;email&quot;] claims

-- Generate decoy digests
decoy1 &lt;- addDecoyDigest SHA256
decoy2 &lt;- addDecoyDigest SHA256

-- Add decoy digests to the _sd array
case payloadValue payload of
  Aeson.Object obj -&gt; do
    case KeyMap.lookup &quot;_sd&quot; obj of
      Just (Aeson.Array sdArray) -&gt; do
        let decoyDigests = [Aeson.String (unDigest decoy1), Aeson.String (unDigest decoy2)]
        let updatedSDArray = sdArray &lt;&gt; V.fromList decoyDigests
        let updatedObj = KeyMap.insert &quot;_sd&quot; (Aeson.Array updatedSDArray) obj
        -- Sign the updated payload...
      _ -&gt; -- Handle error
  _ -&gt; -- Handle error
</pre><p>During verification, decoy digests that don't match any disclosure are
 automatically ignored, so they don't affect verification.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:createSDJWT">createSDJWT</a> :: <a href="SDJWT-Internal-JWT.html#t:JWKLike" title="SDJWT.Internal.JWT">JWKLike</a> jwk =&gt; <a href="../base-4.18.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../base-4.18.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="SDJWT-Internal-Types.html#t:HashAlgorithm" title="SDJWT.Internal.Types">HashAlgorithm</a> -&gt; jwk -&gt; [<a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a>] -&gt; Object -&gt; <a href="../base-4.18.1.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.18.1.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="SDJWT-Internal-Types.html#t:SDJWTError" title="SDJWT.Internal.Types">SDJWTError</a> <a href="SDJWT-Internal-Types.html#t:SDJWT" title="SDJWT.Internal.Types">SDJWT</a>)</li><li class="src short"><a href="#v:createSDJWTWithDecoys">createSDJWTWithDecoys</a> :: <a href="SDJWT-Internal-JWT.html#t:JWKLike" title="SDJWT.Internal.JWT">JWKLike</a> jwk =&gt; <a href="../base-4.18.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../base-4.18.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="SDJWT-Internal-Types.html#t:HashAlgorithm" title="SDJWT.Internal.Types">HashAlgorithm</a> -&gt; jwk -&gt; [<a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a>] -&gt; Object -&gt; <a href="../base-4.18.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="../base-4.18.1.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.18.1.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="SDJWT-Internal-Types.html#t:SDJWTError" title="SDJWT.Internal.Types">SDJWTError</a> <a href="SDJWT-Internal-Types.html#t:SDJWT" title="SDJWT.Internal.Types">SDJWT</a>)</li><li class="src short"><a href="#v:addDecoyDigest">addDecoyDigest</a> :: <a href="SDJWT-Internal-Types.html#t:HashAlgorithm" title="SDJWT.Internal.Types">HashAlgorithm</a> -&gt; <a href="../base-4.18.1.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="SDJWT-Internal-Types.html#t:Digest" title="SDJWT.Internal.Types">Digest</a></li><li class="src short"><a href="#v:buildSDJWTPayload">buildSDJWTPayload</a> :: <a href="SDJWT-Internal-Types.html#t:HashAlgorithm" title="SDJWT.Internal.Types">HashAlgorithm</a> -&gt; [<a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a>] -&gt; Object -&gt; <a href="../base-4.18.1.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.18.1.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="SDJWT-Internal-Types.html#t:SDJWTError" title="SDJWT.Internal.Types">SDJWTError</a> (<a href="SDJWT-Internal-Types.html#t:SDJWTPayload" title="SDJWT.Internal.Types">SDJWTPayload</a>, [<a href="SDJWT-Internal-Types.html#t:EncodedDisclosure" title="SDJWT.Internal.Types">EncodedDisclosure</a>]))</li><li class="src short"><a href="#v:addHolderKeyToClaims">addHolderKeyToClaims</a> :: <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; Object -&gt; Object</li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Public API</h1></a><div class="top"><p class="src"><a id="v:createSDJWT" class="def">createSDJWT</a> <a href="#v:createSDJWT" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="SDJWT-Internal-JWT.html#t:JWKLike" title="SDJWT.Internal.JWT">JWKLike</a> jwk</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="../base-4.18.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a></td><td class="doc"><p>Optional typ header value (RFC 9901 Section 9.11 recommends explicit typing). If <code>Nothing</code>, no typ header is added. If <code>Just &quot;sd-jwt&quot;</code> or <code>Just &quot;example+sd-jwt&quot;</code>, the typ header is included in the JWT header.</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a></td><td class="doc"><p>Optional kid header value (Key ID for key management). If <code>Nothing</code>, no kid header is added.</p></td></tr><tr><td class="src">-&gt; <a href="SDJWT-Internal-Types.html#t:HashAlgorithm" title="SDJWT.Internal.Types">HashAlgorithm</a></td><td class="doc"><p>Hash algorithm for digests</p></td></tr><tr><td class="src">-&gt; jwk</td><td class="doc"><p>Issuer private key JWK (Text or jose JWK object)</p></td></tr><tr><td class="src">-&gt; [<a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a>]</td><td class="doc"><p>Claim names to mark as selectively disclosable</p></td></tr><tr><td class="src">-&gt; Object</td><td class="doc"><p>Original claims object. May include standard JWT claims such as <code>exp</code> (expiration time), <code>nbf</code> (not before), <code>iss</code> (issuer), <code>sub</code> (subject), <code>iat</code> (issued at), etc. These standard claims will be validated during verification if present (see <code><a href="SDJWT-Internal-Verification.html#v:verifySDJWT" title="SDJWT.Internal.Verification">verifySDJWT</a></code>).</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.1.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.18.1.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="SDJWT-Internal-Types.html#t:SDJWTError" title="SDJWT.Internal.Types">SDJWTError</a> <a href="SDJWT-Internal-Types.html#t:SDJWT" title="SDJWT.Internal.Types">SDJWT</a>)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Create a complete SD-JWT (signed).</p><p>This function creates an SD-JWT and signs it using the issuer's key.
 Creates a complete SD-JWT with signed JWT using jose.</p><p>Returns the created SD-JWT or an error.</p><h2>Standard JWT Claims</h2><p>Standard JWT claims (RFC 7519) can be included in the <code>claims</code> map and will be preserved
 in the issuer-signed JWT payload. During verification, standard claims like <code>exp</code> and <code>nbf</code>
 are automatically validated if present. See RFC 9901 Section 4.1 for details.</p><h2>Example</h2><pre>-- Create SD-JWT without typ header
result &lt;- createSDJWT Nothing SHA256 issuerKey [&quot;given_name&quot;, &quot;family_name&quot;] claims

-- Create SD-JWT with typ header
result &lt;- createSDJWT (Just &quot;sd-jwt&quot;) SHA256 issuerKey [&quot;given_name&quot;, &quot;family_name&quot;] claims

-- Create SD-JWT with expiration time
let claimsWithExp = Map.insert &quot;exp&quot; (Aeson.Number (fromIntegral expirationTime)) claims
result &lt;- createSDJWT (Just &quot;sd-jwt&quot;) SHA256 issuerKey [&quot;given_name&quot;] claimsWithExp
</pre></div></div><div class="top"><p class="src"><a id="v:createSDJWTWithDecoys" class="def">createSDJWTWithDecoys</a> <a href="#v:createSDJWTWithDecoys" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="SDJWT-Internal-JWT.html#t:JWKLike" title="SDJWT.Internal.JWT">JWKLike</a> jwk</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="../base-4.18.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a></td><td class="doc"><p>Optional typ header value (e.g., Just &quot;sd-jwt&quot; or Just &quot;example+sd-jwt&quot;). If <code>Nothing</code>, no typ header is added.</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a></td><td class="doc"><p>Optional kid header value (Key ID for key management). If <code>Nothing</code>, no kid header is added.</p></td></tr><tr><td class="src">-&gt; <a href="SDJWT-Internal-Types.html#t:HashAlgorithm" title="SDJWT.Internal.Types">HashAlgorithm</a></td><td class="doc"><p>Hash algorithm for digests</p></td></tr><tr><td class="src">-&gt; jwk</td><td class="doc"><p>Issuer private key JWK (Text or jose JWK object)</p></td></tr><tr><td class="src">-&gt; [<a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a>]</td><td class="doc"><p>Claim names to mark as selectively disclosable</p></td></tr><tr><td class="src">-&gt; Object</td><td class="doc"><p>Original claims object. May include standard JWT claims such as <code>exp</code> (expiration time), <code>nbf</code> (not before), <code>iss</code> (issuer), <code>sub</code> (subject), <code>iat</code> (issued at), etc. These standard claims will be validated during verification if present (see <code><a href="SDJWT-Internal-Verification.html#v:verifySDJWT" title="SDJWT.Internal.Verification">verifySDJWT</a></code>).</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.1.0/Data-Int.html#t:Int" title="Data.Int">Int</a></td><td class="doc"><p>Number of decoy digests to add (must be &gt;= 0)</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.1.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.18.1.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="SDJWT-Internal-Types.html#t:SDJWTError" title="SDJWT.Internal.Types">SDJWTError</a> <a href="SDJWT-Internal-Types.html#t:SDJWT" title="SDJWT.Internal.Types">SDJWT</a>)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Create an SD-JWT with optional typ header and decoy digests.</p><p>This function is similar to <code><a href="SDJWT-Internal-Issuance.html#v:createSDJWT" title="SDJWT.Internal.Issuance">createSDJWT</a></code> but automatically adds
 a specified number of decoy digests to the <code>_sd</code> array to obscure the
 actual number of selectively disclosable claims.</p><p>Returns the created SD-JWT or an error.</p><h2>Standard JWT Claims</h2><p>Standard JWT claims (RFC 7519) can be included in the <code>claims</code> map and will be preserved
 in the issuer-signed JWT payload. During verification, standard claims like <code>exp</code> and <code>nbf</code>
 are automatically validated if present. See RFC 9901 Section 4.1 for details.</p><h2>Example</h2><pre>-- Create SD-JWT with 5 decoy digests, no typ header
result &lt;- createSDJWTWithDecoys Nothing SHA256 issuerKey [&quot;given_name&quot;, &quot;email&quot;] claims 5

-- Create SD-JWT with 5 decoy digests and typ header
result &lt;- createSDJWTWithDecoys (Just &quot;sd-jwt&quot;) SHA256 issuerKey [&quot;given_name&quot;, &quot;email&quot;] claims 5
</pre></div></div><div class="top"><p class="src"><a id="v:addDecoyDigest" class="def">addDecoyDigest</a> :: <a href="SDJWT-Internal-Types.html#t:HashAlgorithm" title="SDJWT.Internal.Types">HashAlgorithm</a> -&gt; <a href="../base-4.18.1.0/System-IO.html#t:IO" title="System.IO">IO</a> <a href="SDJWT-Internal-Types.html#t:Digest" title="SDJWT.Internal.Types">Digest</a> <a href="#v:addDecoyDigest" class="selflink">#</a></p><div class="doc"><p>Generate a decoy digest.</p><p>Decoy digests are random digests that don't correspond to any disclosure.
 They are used to obscure the actual number of selectively disclosable claims.</p><p>According to RFC 9901 Section 4.2.5, decoy digests should be created by
 hashing over a cryptographically secure random number, then base64url encoding.</p><h2>Advanced Use</h2><p>Decoy digests are an advanced feature used to hide the number of selectively
 disclosable claims. They are optional and must be manually added to the _sd array
 if you want to obscure the actual number of selectively disclosable claims.</p><p>To use decoy digests, call this function to generate them and manually add
 them to the _sd array in your payload. This is useful for privacy-preserving
 applications where you want to hide how many claims are selectively disclosable.</p></div></div><div class="top"><p class="src"><a id="v:buildSDJWTPayload" class="def">buildSDJWTPayload</a> <a href="#v:buildSDJWTPayload" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="SDJWT-Internal-Types.html#t:HashAlgorithm" title="SDJWT.Internal.Types">HashAlgorithm</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; [<a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a>]</td><td class="doc"><p>Claim names to mark as selectively disclosable (supports JSON Pointer syntax for nested paths)</p></td></tr><tr><td class="src">-&gt; Object</td><td class="doc"><p>Original claims object</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.1.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.18.1.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="SDJWT-Internal-Types.html#t:SDJWTError" title="SDJWT.Internal.Types">SDJWTError</a> (<a href="SDJWT-Internal-Types.html#t:SDJWTPayload" title="SDJWT.Internal.Types">SDJWTPayload</a>, [<a href="SDJWT-Internal-Types.html#t:EncodedDisclosure" title="SDJWT.Internal.Types">EncodedDisclosure</a>]))</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><a id="v:addHolderKeyToClaims" class="def">addHolderKeyToClaims</a> <a href="#v:addHolderKeyToClaims" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a></td><td class="doc"><p>Holder's public key as a JWK JSON string</p></td></tr><tr><td class="src">-&gt; Object</td><td class="doc"><p>Original claims object</p></td></tr><tr><td class="src">-&gt; Object</td><td class="doc"><p>Claims object with <code>cnf</code> claim added</p></td></tr></table></div><div class="doc"><p>Add holder's public key to claims as a <code>cnf</code> claim (RFC 7800).</p><p>This convenience function adds the holder's public key to the claims map
 in the format required by RFC 7800 for key confirmation:</p><pre>{
  &quot;cnf&quot;: {
    &quot;jwk&quot;: &quot;<a href="holderPublicKeyJWK">holderPublicKeyJWK</a>&quot;
  }
}
</pre><p>The <code>cnf</code> claim is used during key binding to prove that the holder
 possesses the corresponding private key.</p><h2>Example</h2><pre>let holderPublicKeyJWK = &quot;{&quot;kty&quot;:&quot;EC&quot;,&quot;crv&quot;:&quot;P-256&quot;,&quot;x&quot;:&quot;...&quot;,&quot;y&quot;:&quot;...&quot;}&quot;
let claimsWithCnf = addHolderKeyToClaims holderPublicKeyJWK claims
result &lt;- createSDJWT (Just &quot;sd-jwt&quot;) SHA256 issuerKey [&quot;given_name&quot;] claimsWithCnf
</pre><h2>See Also</h2><ul><li>RFC 7800: Proof-of-Possession Key Semantics for JSON Web Tokens (JWT)</li><li>RFC 9901 Section 4.3: Key Binding</li></ul></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.1</p></div></body></html>