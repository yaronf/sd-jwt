<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>SDJWT.Internal.JWT</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">sd-jwt-0.1.0.1: Selective Disclosure for JSON Web Tokens (RFC 9901)</span><ul class="links" id="page-menu"><li id="quick-jump-button"><a href="#">Quick Jump</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">SDJWT.Internal.JWT</p></div><div id="description"><p class="caption">Description</p><div class="doc"><p>JWT signing and verification using jose library.</p><p>This module provides functions for signing and verifying JWTs using the
 jose library. It supports both Text-based JWK strings and jose JWK objects.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:signJWT">signJWT</a> :: <a href="SDJWT-Internal-JWT.html#t:JWKLike" title="SDJWT.Internal.JWT">JWKLike</a> jwk =&gt; jwk -&gt; Value -&gt; <a href="../base-4.18.1.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.18.1.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="SDJWT-Internal-Types.html#t:SDJWTError" title="SDJWT.Internal.Types">SDJWTError</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a>)</li><li class="src short"><a href="#v:signJWTWithOptionalTyp">signJWTWithOptionalTyp</a> :: <a href="SDJWT-Internal-JWT.html#t:JWKLike" title="SDJWT.Internal.JWT">JWKLike</a> jwk =&gt; <a href="../base-4.18.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; jwk -&gt; Value -&gt; <a href="../base-4.18.1.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.18.1.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="SDJWT-Internal-Types.html#t:SDJWTError" title="SDJWT.Internal.Types">SDJWTError</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a>)</li><li class="src short"><a href="#v:signJWTWithHeaders">signJWTWithHeaders</a> :: <a href="SDJWT-Internal-JWT.html#t:JWKLike" title="SDJWT.Internal.JWT">JWKLike</a> jwk =&gt; <a href="../base-4.18.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../base-4.18.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; jwk -&gt; Value -&gt; <a href="../base-4.18.1.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.18.1.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="SDJWT-Internal-Types.html#t:SDJWTError" title="SDJWT.Internal.Types">SDJWTError</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a>)</li><li class="src short"><a href="#v:signJWTWithTyp">signJWTWithTyp</a> :: <a href="SDJWT-Internal-JWT.html#t:JWKLike" title="SDJWT.Internal.JWT">JWKLike</a> jwk =&gt; <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; jwk -&gt; Value -&gt; <a href="../base-4.18.1.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.18.1.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="SDJWT-Internal-Types.html#t:SDJWTError" title="SDJWT.Internal.Types">SDJWTError</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a>)</li><li class="src short"><a href="#v:verifyJWT">verifyJWT</a> :: <a href="SDJWT-Internal-JWT.html#t:JWKLike" title="SDJWT.Internal.JWT">JWKLike</a> jwk =&gt; jwk -&gt; <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../base-4.18.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../base-4.18.1.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.18.1.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="SDJWT-Internal-Types.html#t:SDJWTError" title="SDJWT.Internal.Types">SDJWTError</a> Value)</li><li class="src short"><a href="#v:parseJWKFromText">parseJWKFromText</a> :: <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../base-4.18.1.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="SDJWT-Internal-Types.html#t:SDJWTError" title="SDJWT.Internal.Types">SDJWTError</a> JWK</li><li class="src short"><span class="keyword">class</span> <a href="#t:JWKLike">JWKLike</a> a <span class="keyword">where</span><ul class="subs"><li><a href="#v:toJWK">toJWK</a> :: a -&gt; <a href="../base-4.18.1.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="SDJWT-Internal-Types.html#t:SDJWTError" title="SDJWT.Internal.Types">SDJWTError</a> JWK</li></ul></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:signJWT" class="def">signJWT</a> <a href="#v:signJWT" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="SDJWT-Internal-JWT.html#t:JWKLike" title="SDJWT.Internal.JWT">JWKLike</a> jwk</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; jwk</td><td class="doc"><p>Private key JWK (Text or jose JWK object)</p></td></tr><tr><td class="src">-&gt; Value</td><td class="doc"><p>JWT payload</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.1.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.18.1.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="SDJWT-Internal-Types.html#t:SDJWTError" title="SDJWT.Internal.Types">SDJWTError</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a>)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Sign a JWT payload using a private key.</p><p>Returns the signed JWT as a compact string, or an error.
 Automatically detects key type and uses:</p><ul><li>PS256 for RSA keys (default, RS256 also supported via JWK &quot;alg&quot; field)</li><li>EdDSA for Ed25519 keys</li><li>ES256 for EC P-256 keys</li></ul></div></div><div class="top"><p class="src"><a id="v:signJWTWithOptionalTyp" class="def">signJWTWithOptionalTyp</a> <a href="#v:signJWTWithOptionalTyp" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="SDJWT-Internal-JWT.html#t:JWKLike" title="SDJWT.Internal.JWT">JWKLike</a> jwk</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="../base-4.18.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a></td><td class="doc"><p>Optional typ header value (RFC 9901 Section 9.11 recommends explicit typing)</p></td></tr><tr><td class="src">-&gt; jwk</td><td class="doc"><p>Private key JWK (Text or jose JWK object)</p></td></tr><tr><td class="src">-&gt; Value</td><td class="doc"><p>JWT payload</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.1.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.18.1.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="SDJWT-Internal-Types.html#t:SDJWTError" title="SDJWT.Internal.Types">SDJWTError</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a>)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Sign a JWT payload with optional typ header parameter.</p><p>This function allows setting a typ header for issuer-signed JWTs (RFC 9901 Section 9.11 recommends
 explicit typing, e.g., &quot;sd-jwt&quot; or &quot;example+sd-jwt&quot;). Use <code><a href="SDJWT-Internal-JWT.html#v:signJWT" title="SDJWT.Internal.JWT">signJWT</a></code> for default behavior (no typ header).</p><p>Returns the signed JWT as a compact string, or an error.</p></div></div><div class="top"><p class="src"><a id="v:signJWTWithHeaders" class="def">signJWTWithHeaders</a> <a href="#v:signJWTWithHeaders" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="SDJWT-Internal-JWT.html#t:JWKLike" title="SDJWT.Internal.JWT">JWKLike</a> jwk</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="../base-4.18.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a></td><td class="doc"><p>Optional typ header value (RFC 9901 Section 9.11 recommends explicit typing, e.g., &quot;sd-jwt&quot;)</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a></td><td class="doc"><p>Optional kid header value (Key ID for key management)</p></td></tr><tr><td class="src">-&gt; jwk</td><td class="doc"><p>Private key JWK (Text or jose JWK object)</p></td></tr><tr><td class="src">-&gt; Value</td><td class="doc"><p>JWT payload</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.1.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.18.1.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="SDJWT-Internal-Types.html#t:SDJWTError" title="SDJWT.Internal.Types">SDJWTError</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a>)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Sign a JWT payload with optional typ and kid header parameters.</p><p>This function allows setting <code>typ</code> and <code>kid</code> headers for issuer-signed JWTs.
 Both headers are supported natively through jose's API.</p><p>Returns the signed JWT as a compact string, or an error.</p></div></div><div class="top"><p class="src"><a id="v:signJWTWithTyp" class="def">signJWTWithTyp</a> <a href="#v:signJWTWithTyp" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="SDJWT-Internal-JWT.html#t:JWKLike" title="SDJWT.Internal.JWT">JWKLike</a> jwk</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a></td><td class="doc"><p>typ header value (e.g., &quot;kb+jwt&quot; for KB-JWT)</p></td></tr><tr><td class="src">-&gt; jwk</td><td class="doc"><p>Private key JWK (Text or jose JWK object)</p></td></tr><tr><td class="src">-&gt; Value</td><td class="doc"><p>JWT payload</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.1.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.18.1.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="SDJWT-Internal-Types.html#t:SDJWTError" title="SDJWT.Internal.Types">SDJWTError</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a>)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Sign a JWT payload with a custom typ header parameter.</p><p>This function constructs the JWT header with the specified typ value,
 then signs the JWT. This is needed for KB-JWT which requires typ: &quot;kb+jwt&quot;
 (RFC 9901 Section 4.3).</p><p>Supports all algorithms: EC P-256 (ES256), RSA (PS256 default, RS256 also supported), and Ed25519 (EdDSA).</p><p>Returns the signed JWT as a compact string, or an error.</p></div></div><div class="top"><p class="src"><a id="v:verifyJWT" class="def">verifyJWT</a> <a href="#v:verifyJWT" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="SDJWT-Internal-JWT.html#t:JWKLike" title="SDJWT.Internal.JWT">JWKLike</a> jwk</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; jwk</td><td class="doc"><p>Public key JWK (Text or jose JWK object)</p></td></tr><tr><td class="src">-&gt; <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a></td><td class="doc"><p>JWT to verify as a compact string</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.1.0/Data-Maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a></td><td class="doc"><p>Required typ header value (Nothing = allow any/none, Just &quot;sd-jwt&quot; = require exactly &quot;sd-jwt&quot;)</p></td></tr><tr><td class="src">-&gt; <a href="../base-4.18.1.0/System-IO.html#t:IO" title="System.IO">IO</a> (<a href="../base-4.18.1.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="SDJWT-Internal-Types.html#t:SDJWTError" title="SDJWT.Internal.Types">SDJWTError</a> Value)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Verify a JWT signature using a public key.</p><p>Returns the decoded payload if verification succeeds, or an error.</p></div></div><div class="top"><p class="src"><a id="v:parseJWKFromText" class="def">parseJWKFromText</a> :: <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../base-4.18.1.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="SDJWT-Internal-Types.html#t:SDJWTError" title="SDJWT.Internal.Types">SDJWTError</a> JWK <a href="#v:parseJWKFromText" class="selflink">#</a></p><div class="doc"><p>Parse a JWK from JSON Text.</p><p>Parses a JSON Web Key (JWK) from its JSON representation.
 Supports RSA, Ed25519, and EC P-256 keys.</p><p>The JWK JSON format follows RFC 7517. Examples:</p><ul><li>RSA public key: {&quot;kty&quot;:<a href="RSA.html">RSA</a>,&quot;n&quot;:&quot;...&quot;,&quot;e&quot;:&quot;...&quot;}</li><li>Ed25519 public key: {&quot;kty&quot;:<a href="OKP.html">OKP</a>,&quot;crv&quot;:<a href="Ed25519.html">Ed25519</a>,&quot;x&quot;:&quot;...&quot;}</li><li>EC P-256 public key: {&quot;kty&quot;:<a href="EC.html">EC</a>,&quot;crv&quot;:&quot;P-256&quot;,&quot;x&quot;:&quot;...&quot;,&quot;y&quot;:&quot;...&quot;}</li><li>RSA private key: {&quot;kty&quot;:<a href="RSA.html">RSA</a>,&quot;n&quot;:&quot;...&quot;,&quot;e&quot;:&quot;...&quot;,&quot;d&quot;:&quot;...&quot;,&quot;p&quot;:&quot;...&quot;,&quot;q&quot;:&quot;...&quot;}</li><li>Ed25519 private key: {&quot;kty&quot;:<a href="OKP.html">OKP</a>,&quot;crv&quot;:<a href="Ed25519.html">Ed25519</a>,&quot;d&quot;:&quot;...&quot;,&quot;x&quot;:&quot;...&quot;}</li><li>EC P-256 private key: {&quot;kty&quot;:<a href="EC.html">EC</a>,&quot;crv&quot;:&quot;P-256&quot;,&quot;d&quot;:&quot;...&quot;,&quot;x&quot;:&quot;...&quot;,&quot;y&quot;:&quot;...&quot;}</li></ul></div></div><div class="top"><p class="src"><span class="keyword">class</span> <a id="t:JWKLike" class="def">JWKLike</a> a <span class="keyword">where</span> <a href="#t:JWKLike" class="selflink">#</a></p><div class="doc"><p>Type class for types that can be converted to a jose JWK.</p><p>This allows functions to accept both Text (JWK JSON strings) and jose JWK objects.
 Users can pass JWK strings directly without importing jose, or pass jose JWK objects
 if they're already working with the jose library.</p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a id="v:toJWK" class="def">toJWK</a> :: a -&gt; <a href="../base-4.18.1.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="SDJWT-Internal-Types.html#t:SDJWTError" title="SDJWT.Internal.Types">SDJWTError</a> JWK <a href="#v:toJWK" class="selflink">#</a></p><div class="doc"><p>Convert to a jose JWK object.</p></div></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:JWKLike">Instances</h4><details id="i:JWKLike" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:ic:JWKLike:JWKLike:1"></span> <a href="SDJWT-Internal-JWT.html#t:JWKLike" title="SDJWT.Internal.JWT">JWKLike</a> JWK</span> <a href="#t:JWKLike" class="selflink">#</a></td><td class="doc"><p>JWK instance: identity conversion (already a JWK).</p></td></tr><tr><td colspan="2"><details id="i:ic:JWKLike:JWKLike:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="SDJWT-Internal-JWT.html">SDJWT.Internal.JWT</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toJWK">toJWK</a> :: JWK -&gt; <a href="../base-4.18.1.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="SDJWT-Internal-Types.html#t:SDJWTError" title="SDJWT.Internal.Types">SDJWTError</a> JWK <a href="#v:toJWK" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:ic:JWKLike:JWKLike:2"></span> <a href="SDJWT-Internal-JWT.html#t:JWKLike" title="SDJWT.Internal.JWT">JWKLike</a> <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a></span> <a href="#t:JWKLike" class="selflink">#</a></td><td class="doc"><p>Text instance: parse JWK from JSON string.</p></td></tr><tr><td colspan="2"><details id="i:ic:JWKLike:JWKLike:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="SDJWT-Internal-JWT.html">SDJWT.Internal.JWT</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:toJWK">toJWK</a> :: <a href="../text-2.0.2/Data-Text.html#t:Text" title="Data.Text">Text</a> -&gt; <a href="../base-4.18.1.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="SDJWT-Internal-Types.html#t:SDJWTError" title="SDJWT.Internal.Types">SDJWTError</a> JWK <a href="#v:toJWK" class="selflink">#</a></p></div></details></td></tr></table></details></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.29.1</p></div></body></html>